"
" ██╗   ██╗██╗███╗   ███╗██████╗  ██████╗
" ██║   ██║██║████╗ ████║██╔══██╗██╔════╝
" ██║   ██║██║██╔████╔██║██████╔╝██║
" ╚██╗ ██╔╝██║██║╚██╔╝██║██╔══██╗██║
"  ╚████╔╝ ██║██║ ╚═╝ ██║██║  ██║╚██████╗
"   ╚═══╝  ╚═╝╚═╝     ╚═╝╚═╝  ╚═╝ ╚═════╝
"
"  @author: yusiwen@gmail.com
"  ~/.vimrc is a symbolic link to ~/myConfigs/vim/vimrc

set nocompatible               " be iMproved

" Vundle {{{
  filetype off
  set rtp+=~/.vim/bundle/Vundle.vim/
  call vundle#begin()

  " let Vundle manage Vundle
  Plugin 'gmarik/Vundle.vim'

  " quoting/parenthesizing made simple
  Plugin 'tpope/vim-surround'
  " pairs of handy bracket mappings
  Plugin 'tpope/vim-unimpaired'
  " insert or delete brackets, parens, quotes in pair
  Plugin 'jiangmiao/auto-pairs'

  " displays tags in a window
  Plugin 'majutsushi/tagbar'
  " Ctags generator for Vim
  Plugin 'szw/vim-tags'
  " Automatically discover and update ctags files on save
  Plugin 'craigemery/vim-autotag'
  " tree explorer plugin for vim
  Plugin 'scrooloose/nerdtree'
  Plugin 'Xuyuanp/nerdtree-git-plugin'
  Plugin 'bling/vim-airline'

  " easy note taking in Vim
  Plugin 'xolox/vim-misc'
  Plugin 'xolox/vim-notes'

  " sublime text style multiple selection
  Plugin 'terryma/vim-multiple-cursors'
  " visually select increasingly larger regions
  Plugin 'terryma/vim-expand-region'

  " Shuogo's neo packages
  Plugin 'Shougo/vimproc.vim'
  Plugin 'Shougo/unite.vim'
  Plugin 'Shougo/unite-session'
  Plugin 'Shougo/neomru.vim'
  "Plugin 'Shougo/vimfiler.vim'
  Plugin 'Shougo/neocomplete.vim'
  "Plugin 'Shougo/neosnippet.vim'
  "Plugin 'Shougo/neosnippet-snippets'
  "Plugin 'honza/vim-snippets'
  Plugin 'tsukkee/unite-tag'

  " extensible & universal comment
  Plugin 'tomtom/tcomment_vim'
  " colorize text in the form #rrggbb or #rgb
  Plugin 'lilydjwg/colorizer'
  " text filtering and alignment
  Plugin 'godlygeek/tabular'
  " accelerated smooth scroll
  Plugin 'yonchu/accelerated-smooth-scroll'
  " better whitespace highlighting
  Plugin 'ntpeters/vim-better-whitespace'
  " Vim motions on speed!
  Plugin 'easymotion/vim-easymotion'
  " enable repeating supported plugin maps with "."
  Plugin 'tpope/vim-repeat'

  " Language & Develop specific repos
  " git wrapper
  Plugin 'tpope/vim-fugitive'
  " gitk for Vim
  Plugin 'gregsexton/gitv'
  " shows a git diff in the gutter
  Plugin 'airblade/vim-gitgutter'
  " groovy
  Plugin 'vim-scripts/groovy.vim'
  " gradle support
  Plugin 'tfnico/vim-gradle'
  " wisely add 'end' in ruby, vim script, etc
  Plugin 'tpope/vim-endwise'
  " Ruby on Rails power tools
  Plugin 'tpope/vim-rails'
  " mappings for HTML, XML, PHP, eRuby, JSP, etc
  Plugin 'tpope/vim-ragtag'
  " runtime files for Haml, Sass, and SCSS
  Plugin 'tpope/vim-haml'
  " tools for developing Node.js
  Plugin 'moll/vim-node'
  " improved Javascript indentation and syntax
  Plugin 'pangloss/vim-javascript'
  " CoffeeScript support
  Plugin 'kchmck/vim-coffee-script'
  " markdown extensions
  Plugin 'plasticboy/vim-markdown'
  " view man pages in vim
  Plugin 'bruno-/vim-man'

  " 'fcitx.vim' is only needed under Linux
  if has("unix")
    let s:uname = substitute(system('uname'), '\n', '', '')
      if s:uname == "Linux"
        " keep/restore fcitx state when toggling insert mode
        Plugin 'vim-scripts/fcitx.vim'
      endif
  endif
  " extended % matching for HTML, LaTeX, etc
  Plugin 'vim-scripts/matchit.zip'

  " themes repos
  "Plugin 'altercation/vim-colors-solarized'
  "Plugin 'nanotech/jellybeans.vim'
  "Plugin 'jnurmine/Zenburn'
  "Plugin 'morhetz/gruvbox'
  "Plugin 'chriskempson/base16-vim'

  call vundle#end()
" }}}

" General settings {{{

  filetype plugin indent on
  syntax on

  set title
  set mouse=a

  set shortmess=at      " shorten error messages

  set nrformats+=alpha  " in-/decrease letters with C-a/C-x

  set modeline          " enable modelines
  set modelines=5

  set selection=inclusive

  set number            " enable line numbers
  set ruler             " enable something
  set cursorline        " enable hiliting of cursor line

  set backspace=2       " backspace over EOL etc.

  set background=dark   " i prefer dark backgrounds

  set hidden            " buffer switching should be quick
  set confirm           " ask instead of just print errors

  set equalalways       " make splits equal size
  " Always splits to the right and below
  set splitright
  set splitbelow

  set lazyredraw        " don't redraw while executing macros

  set noshowmode        " don't display mode, it's already in the status line

  set laststatus=2      " always show statusline

  set encoding=utf-8    " Necessary to show Unicode glyphs
  set fileencodings=ucs-bom,utf-8,cp936,gb18030,big5,euc-jp,euc-kr,latin1

  set timeoutlen=500
  set ttimeoutlen=50

  set fillchars=""
" }}}

" General Keybindings & Mappings {{{

  let mapleader=","
  let maplocalleader=","

  set pastetoggle=<F10>

" Allow saving of files as sudo when I forgot to start vim using sudo.
"  command W w !sudo tee % > /dev/null
" }}}

" GUI or no GUI, that's the question {{{
  if has('gui_running')
    set guicursor+=a:blinkon0       " Cursor doesn't blink - it's annoying
    set guioptions-=m               " No Menubar
    set guioptions-=T               " No Toolbar
    set guioptions-=l               " No Scrollbar left
    set guioptions-=L               " No Scrollbar left when split
    set guioptions-=r               " No Scrollbar right
    set guioptions-=r               " No Scrollbar right when split

    set guifont=Input\ Mono\ 10

    set lines=40                    " Height
    set columns=85                  " Width

    set background=dark

    colorscheme sourcerer
  else
    colorscheme sourcerer
    set t_Co=256
  endif
" }}}

" Tabstops {{{
  set tabstop=2
  set shiftwidth=2
  set softtabstop=2
  set autoindent
  set smartindent
  set expandtab
" }}}

" Invisibles {{{
" tab: U+25BA, extends: U+00BB, precedes:U+00AB, trail:U+2017, eol:U+00AC
  set listchars=tab:►\ ,extends:»,precedes:«,trail:_,eol:¬
  set list
  nmap <silent> <F11> :set list!<CR>
" }}}

" Folds {{{
  set foldmethod=marker
  set foldcolumn=1
" }}}

" Pairings {{{
  set showmatch
" }}}

" Margins {{{
  set scrolloff=5
  set sidescroll=5
" }}}

" Search {{{
  set incsearch
  set ignorecase

  " Toggle that stupid highlight search
  nmap <silent> ,n :set invhls<CR>:set hls?<CR>
" }}}

" Backup and Recovery {{{
  set nobackup
  set writebackup
" set swap file directory to ~/.vim/swap, need to mkdir it first
  set directory=~/.vim/swap,.
  set swapfile
" }}}

" Completion {{{
  set wildmenu
  set wildmode=longest,full,list

  set ofu=syntaxcomplete#Complete
" }}}

" Wrapping {{{
  set linebreak
  set showbreak=∟\
" toggle wrapping
  nmap <silent> <F12> :let &wrap = !&wrap<CR>
" }}}

" Tabs Navigatoin {{{

  " Since most terminal emulators do not intercept Ctrl-Tab, they just send the
  " same code as for Tab, use <Leader>(which is ',' by default) intead of <C>
  " If want to change that, please checkout this post below:
  " http://www.staldal.nu/tech/2009/01/10/how-to-use-ctrl-tab-in-gnu-screen/
  nnoremap <Leader><S-Tab> :tabprevious<CR>
  nnoremap <Leader><Tab> :tabnext<CR>
  nnoremap <Leader>nt :tabnew<CR>

  "map <C-W> <Esc>:confirm bdelete<CR>

  inoremap <Leader><Tab> <Esc>:tabnext<CR>
  inoremap <Leader><S-Tab> <Esc>:tabpreviuos<CR>
  inoremap <C-t> <Esc>:tabnew<CR>
" }}}

" Macros {{{
" }}}

" Plugins {{{

" Airline {{{
  source ~/myConfigs/vim/vimrc.airline
" }}}

" unite {{{
  source ~/myConfigs/vim/vimrc.unite
" }}}

" neocomplete {{{
  source ~/myConfigs/vim/vimrc.neocomplete
" }}}

" vim-multiple_cursors {{{
" make NeoComplete compatible with vim-multiple-cursors
  function! Multiple_cursors_before()
    exe 'NeoCompleteLock'
  endfunction

  function! Multiple_cursors_after()
    exe 'NeoCompleteUnlock'
  endfunction
" }}}

" {{{ Eclim
  let g:EclimCompletionMethod = 'omnifunc'
" }}}

" Colorizer {{{
  let g:colorizer_nomap = 1
  let g:colorizer_startup = 0
" }}}

" RagTag {{{
  imap <M-O> <Esc>o
  imap <C-J> <Down>
  let g:ragtag_global_maps = 1

  imap <C-Space> <C-X><Space>
  imap <C-CR> <C-X><CR>
" }}}

" NERDTree {{{
  nnoremap <silent> <Leader>1 :NERDTreeToggle<CR>

  let g:NERDTreeChDirMode = 2
  let g:NERDTreeShowBookmarks = 1
  let g:NERDTreeWinPos = "left"
  let g:NERDTreeShowHidden = 0
" }}}

" Fugitive {{{
  let FugitiveIgnoreBufferTitles = ['NERDTree']
  let FugitivePreferFileBuffers = 1
" }}}

" GitGutter {{{
  source ~/myConfigs/vim/vimrc.gitgutter
" }}}

" TagBar {{{
  nnoremap <silent> <Leader>2 <Esc>:TagbarToggle<CR>
" on mac, default '/bin/ctags' provided by Apple is not exuberant ctags,
" homebrew's ctags is installed under '/usr/local/bin'
  if has("unix")
    let s:uname = substitute(system('uname'), '\n', '', '')
      if s:uname == "Darwin"
        let g:tagbar_ctags_bin = '/usr/local/bin/ctags'
      endif
  endif
" }}}

" vim-tags {{{
" do not let vim-tags auto generate tags on save
" use vim-autotag plugin to do this instead
  let g:vim_tags_auto_generate = 1
" }}}

" vim-notes {{{
  let g:notes_directories = ['~/notes']
  let g:notes_suffix = '.note'
  let g:notes_title_sync = 'change_title'
  let g:notes_tab_indents = 0
" }}}

" vim-better-whitespace {{{
  let g:better_whitespace_enabled=0
" }}}

" vim-easymotion {{{
  let g:EasyMotion_do_mapping = 0 " Disable default mappings

" Bi-directional find motion
" Jump to anywhere you want with minimal keystrokes, with just one key binding.
" `s{char}{label}`
" nmap s <Plug>(easymotion-s)
" or
" `s{char}{char}{label}`
" Need one more keystroke, but on average, it may be more comfortable.
  nmap <Leader>s <Plug>(easymotion-s2)
  nmap <Leader>t <Plug>(easymotion-t2)

  map  / <Plug>(easymotion-sn)
  omap / <Plug>(easymotion-tn)

" These `n` & `N` mappings are options. You do not have to map `n` & `N` to EasyMotion.
" Without these mappings, `n` & `N` works fine. (These mappings just provide
" different highlight method and have some other features )
  map  n <Plug>(easymotion-next)
  map  N <Plug>(easymotion-prev)

" Turn on case insensitive feature
  let g:EasyMotion_smartcase = 1

" JK motions: Line motions
  map <Leader>l <Plug>(easymotion-lineforward)
  map <Leader>j <Plug>(easymotion-j)
  map <Leader>k <Plug>(easymotion-k)
  map <Leader>h <Plug>(easymotion-linebackward)

  let g:EasyMotion_startofline = 0 " keep cursor colum when JK motion
  hi link EasyMotionMoveHL Search
" }}}
" }}}
